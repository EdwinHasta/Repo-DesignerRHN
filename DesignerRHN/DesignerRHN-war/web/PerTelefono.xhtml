<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">
    <h:head>
    </h:head>
    <h:body>
        <ui:composition template="/Template.xhtml">
            <ui:define name="body">                  
                <h:form id="form"> 
                    <p:panel  id="PanelTotal" header="Telefonos" style=" font-size: 13px; position: absolute; width: 874px; height: 530px;" > 

                        <h:outputText style="position: absolute; left: 390px; top: 50px; position: absolute; color: red; font-weight: bold; width: 285px; text-align: right; " id="nombreEmpleado" value="#{controlPerTelefonos.persona.nombreCompleto}"/>

                        <fieldset style="position: absolute; left: 10px; top: 70px; font-size: 10px; width: 645px; height: 320px; border-radius: 10px; ">
                            <legend style="font-size: 13px; color: #14388B"><strong>Telefonos donde ubicar al empleado</strong></legend>

                            <p:dataTable id="datosTelefonosPersona" var="telefono" value="#{controlPerTelefonos.listaTelefonos}"
                                         rowKey="#{telefono.secuencia}" rowIndexVar="indice" style="font-size: 10px; border: 1px; text-align: left"                           
                                         scrollable="true" scrollHeight="200" filteredValue="#{controlPerTelefonos.filtradosListaTelefonos}" 
                                         emptyMessage="No se encontrarón resultados para la búsqueda"
                                         editable="true" editMode="cell" paginator="true" 
                                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}">

                                <p:ajax event="filter" listener="#{controlPerTelefonos.eventoFiltrar()}"/>

                                <p:column headerText="Fecha" sortBy="#{telefono.fechavigencia}" filterBy="#{telefono.fechavigencia}" filterMatchMode="contains"  width="72" id="tFecha" filterStyle="display: none; visibility: hidden;"  >  
                                    <p:cellEditor>  
                                        <f:facet name="output">
                                            <h:outputText value="#{telefono.fechavigencia}" >
                                                <f:convertDateTime pattern="dd/MM/yyyy" />
                                            </h:outputText>
                                        </f:facet>  
                                        <f:facet name="input">
                                            <p:calendar  style="font-size: 10px;" value="#{telefono.fechavigencia}" id="editFecha"   styleClass="ui-datepicker, myClass"  
                                                         navigator="true" showButtonPanel="true" locale="es" pattern="dd/MM/yyyy" autocomplete="true">                                         
                                                <p:ajax event="dateSelect"  update="editFecha"/>
                                                <p:ajax event="change" />
                                                <p:ajax event="select"/>
                                                <f:convertDateTime pattern="dd/MM/yyyy" />
                                            </p:calendar>
                                        </f:facet>   
                                    </p:cellEditor>

                                    <f:facet name="footer">
                                        <h:outputText value="Fecha" />
                                    </f:facet>
                                </p:column>

                                <p:column headerText="Tipo de Telefono" sortBy="#{telefono.tipotelefono.nombre}" filterBy="#{telefono.tipotelefono.nombre}" filterMatchMode="contains" id="tTipoTefono" width="133" filterStyle="display: none; visibility: hidden;" >                                  
                                    <p:cellEditor>  
                                        <f:facet name="output"><h:outputText value="#{telefono.tipotelefono.nombre}" /></f:facet>  
                                        <f:facet name="input">
                                            <p:inputText value="#{telefono.tipotelefono.nombre}" id="editarTipoTelefono" style="font-size: 10px; border-radius: 0px; width: 93.5%;text-transform: uppercase"> 
                                                <p:ajax event="change" />
                                                <p:ajax event="select" />
                                                <p:ajax event="dblclick" listener="#{controlPerTelefonos.asignarIndex(indice, 0)}"/>
                                            </p:inputText>
                                        </f:facet>  
                                    </p:cellEditor>

                                    <f:facet name="footer">
                                        <p:commandButton style="width: 100%; height: 16px; font-size: 9px; border: none; color: blue" id="fooTipoTelefono" value="Tipo Telefono"/>
                                    </f:facet>
                                </p:column>

                                <p:column headerText="Número" sortBy="#{telefono.numerotelefono}" filterBy="#{telefono.numerotelefono}" filterMatchMode="contains" id="tNumero" width="133" filterStyle="display: none; visibility: hidden;" >                                  
                                    <p:cellEditor>  
                                        <f:facet name="output"><h:outputText value="#{telefono.numerotelefono}" /></f:facet>  
                                        <f:facet name="input">
                                            <p:inputText value="#{telefono.numerotelefono}" id="editarNumeroTelefono" style="font-size: 10px; border-radius: 0px; width: 93.5%;text-transform: uppercase" > 
                                                <p:ajax event="select"/>
                                            </p:inputText>
                                        </f:facet>  
                                    </p:cellEditor>

                                    <f:facet name="footer">
                                        <h:outputText value="Número" />
                                    </f:facet>
                                </p:column> 

                                <p:column headerText="Ciudad" sortBy="#{telefono.ciudad.nombre}" filterBy="#{telefono.ciudad.nombre}" filterMatchMode="contains" id="tCiudad" width="133" filterStyle="display: none; visibility: hidden;" >                                  
                                    <p:cellEditor>  
                                        <f:facet name="output"><h:outputText value="#{telefono.ciudad.nombre}" /></f:facet>  
                                        <f:facet name="input">
                                            <p:inputText value="#{telefono.ciudad.nombre}" id="editarCiudad" style="font-size: 10px; border-radius: 0px; width: 93.5%;text-transform: uppercase" > 
                                                <p:ajax event="select"/>
                                                <p:ajax event="dblclick" listener="#{controlPerTelefonos.asignarIndex(indice, 1)}"/>
                                            </p:inputText>
                                        </f:facet>  
                                    </p:cellEditor>

                                    <f:facet name="footer">
                                        <p:commandButton style="width: 100%; height: 16px; font-size: 9px; border: none; color: blue" id="fooCiudad" value="Ciudad"/>
                                    </f:facet>
                                </p:column> 
                            </p:dataTable>  
                        </fieldset>

                        <p:commandButton style="position: absolute; left: 15px; top: 410px; font-size: 11px; font-family: Arial, Helvetica, sans-serif;" id="REFRESCAR" value="Refrescar" icon="ui-icon-refresh" actionListener="#{controlPerTelefonos.refrescar()}" process="@this" />

                    </p:panel> 
                </h:form>

                <h:form id="formularioDialogos">

                    <!--DIALOGO TIPOS DE TELEFONOS-->    
                    <p:dialog header="Tipos de Telefonos" widgetVar="tiposTelefonosDialogo" draggable="false" resizable="false" id="tiposTelefonosDialogo" closable="false"  
                              showEffect="fade" hideEffect="fade" modal="true" width="327" height="225" style="font-size: 12px">

                        <p:dataTable  id="LOVTiposTelefonos" style="font-size: 11px; width: 300px" var="tipoTelefono" value="#{controlPerTelefonos.listaTiposTelefonos}"
                                      scrollable="true" scrollHeight="117" scrollWidth="315" widgetVar="LOVTiposTelefonos" 
                                      filteredValue="#{controlPerTelefonos.filtradoslistaTiposTelefonos}" emptyMessage="No se encontraron resultados con el criterio de busqueda."
                                      rowKey="#{tipoTelefono.secuencia}" selection="#{controlPerTelefonos.seleccionTipoTelefono}" selectionMode="single">
                            <p:ajax event="rowSelect" listener="#{controlPerTelefonos.activarAceptar()}" update=":formularioDialogos:aceptarTT"/>
                            <p:ajax event="rowDblselect" listener="#{controlPerTelefonos.actualizarTiposTelefonos()}" process="@this" onstart="LOVTiposTelefonos.clearFilters()"/>
                            <f:facet name="header">  
                                <h:outputText value="Buscar Tipo de Telefono: "  style="position: absolute; left: 27px; top: 15px"/>  
                                <p:inputText id="globalFilter" onkeyup="LOVTiposTelefonos.filter();" style="width:100px; position: relative; left: 60px;" />  
                            </f:facet>

                            <p:column  filterBy="#{tipoTelefono.codigo}" width="50" filterMatchMode="contains" filterStyle="width: 40px;" > 
                                <f:facet name="header">
                                    <h:outputText value="Código" />
                                </f:facet>
                                <h:outputText value="#{tipoTelefono.codigo}" />  
                            </p:column>  

                            <p:column filterBy="#{tipoTelefono.nombre}" width="150" filterMatchMode="contains" > 
                                <f:facet name="header">
                                    <h:outputText value="Nombre" />
                                </f:facet>
                                <h:outputText value="#{tipoTelefono.nombre}" />  
                            </p:column>
                        </p:dataTable>                         
                        <p:commandButton id="aceptarTT" value="Aceptar" disabled="#{controlPerTelefonos.aceptar}" style="position: absolute; top: 205px; left: 182px; font-size: 12px" actionListener="#{controlPerTelefonos.actualizarTiposTelefonos()}" onclick="LOVTiposTelefonos.clearFilters();" update="aceptarTT" process="@this">
                            <p:resetInput target=":formularioDialogos:LOVTiposTelefonos:globalFilter"/>
                        </p:commandButton>
                        <p:commandButton id="atrasTT" value="Atras" style="position: absolute; top: 205px; left: 255px; font-size: 12px" onclick="tiposTelefonosDialogo.hide(), LOVTiposTelefonos.clearFilters();" actionListener="#{controlPerTelefonos.cancelarCambioTiposTelefonos()}" update="LOVTiposTelefonos, aceptarTT" process="@this">
                            <p:resetInput target=":formularioDialogos:LOVTiposTelefonos:globalFilter"/>
                        </p:commandButton>
                    </p:dialog>
                    <!--DIALOGO CIUDADES-->    
                    <p:dialog header="Ciudades" widgetVar="ciudadesDialogo" draggable="false" resizable="false" id="ciudadesDialogo" closable="false"  
                              showEffect="fade" hideEffect="fade" modal="true" width="327" height="225" style="font-size: 12px">

                        <p:dataTable  id="LOVCiudades" style="font-size: 11px; width: 300px" var="ciudad" value="#{controlPerTelefonos.listaCiudades}"
                                      scrollable="true" scrollHeight="117" scrollWidth="315" liveScroll="true" scrollRows="8" widgetVar="LOVCiudades" 
                                      filteredValue="#{controlPerTelefonos.filtradoslistaCiudades}" emptyMessage="No se encontraron resultados con el criterio de busqueda."
                                      rowKey="#{ciudad.secuencia}" selection="#{controlPerTelefonos.seleccionCiudades}" selectionMode="single">
                            <p:ajax event="rowSelect" listener="#{controlPerTelefonos.activarAceptar()}" update=":formularioDialogos:aceptarC"/>
                            <p:ajax event="rowDblselect" listener="#{controlPerTelefonos.actualizarCiudad()}" process="@this" onstart="LOVCiudades.clearFilters()"/>
                            <f:facet name="header">  
                                <h:outputText value="Buscar Ciudad: "  style="position: absolute; left: 27px; top: 15px"/>  
                                <p:inputText id="globalFilter" onkeyup="LOVCiudades.filter();" style="width:100px; position: relative; left: 60px;" />  
                            </f:facet>

                            <p:column  filterBy="#{ciudad.nombre}" width="50" filterMatchMode="contains" filterStyle="width: 40px;" > 
                                <f:facet name="header">
                                    <h:outputText value="Nombre" />
                                </f:facet>
                                <h:outputText value="#{ciudad.nombre}" />  
                            </p:column>  
                        </p:dataTable>                         
                        <p:commandButton id="aceptarC" value="Aceptar" disabled="#{controlPerTelefonos.aceptar}" style="position: absolute; top: 205px; left: 182px; font-size: 12px" actionListener="#{controlPerTelefonos.actualizarCiudad()}" onclick="LOVCiudades.clearFilters();" update="aceptarC" process="@this">
                            <p:resetInput target=":formularioDialogos:LOVCiudades:globalFilter"/>
                        </p:commandButton>
                        <p:commandButton id="atrasC" value="Atras" style="position: absolute; top: 205px; left: 255px; font-size: 12px" onclick="ciudadesDialogo.hide(), LOVCiudades.clearFilters();" actionListener="#{controlPerTelefonos.cancelarCambioCiudad()}" update="LOVCiudades, aceptarC" process="@this">
                            <p:resetInput target=":formularioDialogos:LOVCiudades:globalFilter"/>
                        </p:commandButton>
                    </p:dialog>
                </h:form>
            </ui:define>
        </ui:composition>
    </h:body>
</html>

